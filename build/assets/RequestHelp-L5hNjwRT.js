import{r as o,n as L,f as Q,e as w,j as e,B as U}from"./index-BvrU90Mr.js";import{L as h,I as p,T as W,g as X}from"./matching-CfRSpC8f.js";function ae(){const[F,D]=o.useState(L),[t,f]=o.useState({title:"",imageUrl:"",category:L[1]??"í™˜ê²½",description:"",skills:"",duration:"",tags:"",contact:""}),[N,A]=o.useState(null),[T,$]=o.useState(""),[v,M]=o.useState(""),[S,_]=o.useState(""),[C,j]=o.useState(!1),[B,y]=o.useState(""),[P,q]=o.useState(!1),[R,Y]=o.useState(!1),[J,O]=o.useState(!1),[G,V]=o.useState(null),[Z,ee]=o.useState(null),u=(t.description||"").trim().length>0,z=s=>s.replace(/\s+/g," ").trim().split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "),E=(s,r=2)=>{const i=[],a=new Set;for(const n of s){const l=String(n||"").toLowerCase().trim().replace(/\s+/g," ");if(!(!l||l.split(" ").length>2)&&!a.has(l)&&(a.add(l),i.push(l),i.length>=r))break}return i},I=(s,r=2)=>{const i=[],a=new Set;for(const n of s){const l=String(n||"").replace(/\s+/g," ").trim();if(!l||l.split(" ").length>3)continue;const m=l.toLowerCase();if(!a.has(m)&&(a.add(m),i.push(z(l)),i.length>=r))break}return i},b=(s,r,i,a=2)=>{const n=i(s.split(",").map(c=>c.trim()).filter(Boolean)),l=i(r),g=[],m=new Set;for(const c of[...n,...l]){const d=c.toLowerCase();if(!m.has(d)&&(m.add(d),g.push(c),g.length>=a))break}return g.join(", ")},x=s=>{const{name:r,value:i}=s.target;r==="category"&&q(!0),r==="tags"&&Y(!0),r==="skills"&&O(!0),f(a=>({...a,[r]:i}))};o.useEffect(()=>{let s=!1;return(async()=>{try{const r=await Q();if(!s&&Array.isArray(r.needsCategories)&&r.needsCategories.length&&(D(r.needsCategories),!r.needsCategories.includes(t.category))){const i=r.needsCategories.find(a=>a!=="ì „ì²´")||r.needsCategories[0];i&&f(a=>({...a,category:i}))}}catch{}})(),()=>{s=!0}},[]);const H=async s=>{s.preventDefault();let r,i=[];try{const d=await w({title:t.title,description:t.description,skills:t.skills.split(",").map(k=>k.trim()).filter(Boolean),tags:t.tags.split(",").map(k=>k.trim()).filter(Boolean),category:t.category});r=d.suggestedCategory||void 0,i=d.tags||[]}catch{}const a=r||t.category,n=Array.from(new Set([...i||[],...t.tags.split(",").map(d=>d.trim()).filter(Boolean)])),l={id:`need-${Date.now()}`,isCustom:!0,title:t.title.trim(),imageUrl:t.imageUrl.trim()||"https://images.unsplash.com/photo-1603575448878-868a20723f5d?w=1080&q=80&auto=format&fit=crop",category:a,description:t.description.trim(),skills:t.skills.split(",").map(d=>d.trim()).filter(Boolean),duration:v&&S?`${v} ~ ${S}`:t.duration.trim()||void 0,contact:t.contact?.trim()||void 0,tags:n,matchingTags:X({type:"needs",category:a,title:t.title,description:t.description,skills:t.skills.split(",").map(d=>d.trim()).filter(Boolean),tags:n}),llmCategory:r,llmTags:i},g="custom_needs",m=localStorage.getItem(g),c=m?JSON.parse(m):[];c.unshift(l),localStorage.setItem(g,JSON.stringify(c)),A(l.id),window.dispatchEvent(new Event("data:updated"))},K=async()=>{j(!0),y("");try{const s=await w({title:t.title,description:t.description,skills:t.skills.split(",").map(a=>a.trim()).filter(Boolean),tags:t.tags.split(",").map(a=>a.trim()).filter(Boolean),category:t.category}),r=b(t.tags,s.tags||[],a=>E(a,2),2),i=b(t.skills,s.skills||[],a=>I(a,2),2);f(a=>({...a,category:s.suggestedCategory||a.category,tags:r,skills:i})),y(`ì¶”ì²œ ì¹´í…Œê³ ë¦¬: ${s.suggestedCategory??"ì—†ìŒ"} Â· ì¶”ì²œ íƒœê·¸ ${s.tags?.length??0}ê°œ (ì‹ ë¢°ë„ ${Math.round((s.confidence||0)*100)}%)`)}catch{y("âš ï¸ ì¶”ì²œ ì„œë²„ì— ì—°ê²°í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ VITE_API_BASEë¥¼ ì„¤ì •í•˜ì„¸ìš”.")}finally{j(!1)}};return o.useEffect(()=>{G||V(t);const s=12,r=(t.description||"").trim(),i=(t.title||"").trim();if(C||r.length<s&&i.length<s)return;const a=setTimeout(async()=>{try{j(!0);const n=await w({title:t.title,description:t.description,skills:t.skills.split(",").map(l=>l.trim()).filter(Boolean),tags:t.tags.split(",").map(l=>l.trim()).filter(Boolean),category:t.category});y(`ì¶”ì²œ ì¹´í…Œê³ ë¦¬: ${n.suggestedCategory??"ì—†ìŒ"} Â· ì¶”ì²œ íƒœê·¸ ${n.tags?.length??0}ê°œ (ì‹ ë¢°ë„ ${Math.round((n.confidence||0)*100)}%)`),f(l=>{const g=R?l.tags:b(l.tags,n.tags||[],c=>E(c,2),2),m=J?l.skills:b(l.skills,n.skills||[],c=>I(c,2),2);return{...l,category:P?l.category:n.suggestedCategory||l.category,tags:g,skills:m}})}catch{y("âš ï¸ ì¶”ì²œ ì„œë²„ì— ì—°ê²°í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê±°ë‚˜ VITE_API_BASEë¥¼ ì„¤ì •í•˜ì„¸ìš”.")}finally{j(!1)}},700);return()=>clearTimeout(a)},[t.description,t.title,t.skills]),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-6",children:[e.jsx("h2",{className:"font-['Inter:Semi_Bold','Noto_Sans_KR:Bold',sans-serif] text-[26px] mb-1 text-gray-900",children:"ë„ì›€ ìš”ì²­í•˜ê¸°"}),N?e.jsxs("div",{className:"rounded-md border border-green-200 bg-green-50 p-4 text-green-800",children:["ìš”ì²­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì— ë°˜ì˜ë©ë‹ˆë‹¤. (ID: ",N,")"]}):e.jsxs("form",{onSubmit:H,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"title",children:"ì œëª©"}),e.jsx(p,{id:"title",name:"title",value:t.title,onChange:x,required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"imageFile",children:"ì´ë¯¸ì§€ ì—…ë¡œë“œ"}),e.jsx(p,{id:"imageFile",type:"file",accept:"image/*",onChange:s=>{const r=s.target.files?.[0];if(!r)return;const i=new FileReader;i.onload=()=>{const a=String(i.result||"");f(n=>({...n,imageUrl:a})),$(a)},i.readAsDataURL(r)}}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG/PNG ê¶Œì¥, ìµœëŒ€ 2MB, ê¶Œì¥ ë¹„ìœ¨ 16:9"}),T||t.imageUrl?e.jsx("img",{src:T||t.imageUrl,alt:"preview",className:"mt-2 w-[160px] h-[114px] object-cover rounded"}):null]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"description",children:"ì„¤ëª…"}),e.jsx(W,{id:"description",name:"description",value:t.description,onChange:x,rows:5,required:!0}),!u&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ì„¤ëª…ì„ ë¨¼ì € ì…ë ¥í•˜ë©´ ë‚˜ë¨¸ì§€ í•­ëª©ì„ ì‘ì„±í•  ìˆ˜ ìˆì–´ìš”."})]}),u&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(U,{type:"button",variant:"outline",onClick:K,disabled:C,className:"w-full h-12 bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200 text-blue-900 hover:from-blue-100 hover:to-blue-200 transition-all duration-200",children:C?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"}),"LLMìœ¼ë¡œ í•˜ë‹¨ ë‚´ìš© ì±„ìš°ëŠ” ì¤‘..."]}):"ğŸ‘‡ğŸ» LLMìœ¼ë¡œ í•˜ë‹¨ ë‚´ìš© ì±„ìš°ê¸° (ì¹´í…Œê³ ë¦¬, ìŠ¤í‚¬, íƒœê·¸ ìë™ ì¶”ì²œ) ğŸ‘‡ğŸ»"}),B&&e.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded text-sm text-blue-800",children:B})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"category",children:"ì¹´í…Œê³ ë¦¬"}),e.jsx("select",{id:"category",name:"category",value:t.category,onChange:x,className:"h-9 w-full rounded-md border px-3 text-sm bg-white",disabled:!u,children:F.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx(h,{children:"ê¸°ê°„"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{placeholder:"ì˜ˆ: 2025.10.23",value:v,onChange:s=>M(s.target.value),disabled:!u}),e.jsx("span",{className:"self-center text-gray-500",children:"~"}),e.jsx(p,{placeholder:"ì˜ˆ: 2025.10.30",value:S,onChange:s=>_(s.target.value),disabled:!u})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"í˜•ì‹: YYYY.MM.DD"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"skills",children:"í•„ìš” ìŠ¤í‚¬ (ì‰¼í‘œ êµ¬ë¶„)"}),e.jsx(p,{id:"skills",name:"skills",value:t.skills,onChange:x,placeholder:"ì˜ˆ: ìŒì„± ì•ˆë‚´, ì•ˆì „ ë³´í–‰",disabled:!u})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"tags",children:"íƒœê·¸ (ì‰¼í‘œ êµ¬ë¶„)"}),e.jsx(p,{id:"tags",name:"tags",value:t.tags,onChange:x,placeholder:"ì˜ˆ: êµìœ¡, ì•ˆì „",disabled:!u})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(h,{htmlFor:"contact",children:"ì—°ë½ì²˜"}),e.jsx(p,{id:"contact",name:"contact",required:!0,onChange:x,placeholder:"ì˜ˆ: ì¹´ì¹´ì˜¤í†¡ @username, ì´ë©”ì¼ hello@example.com",disabled:!u})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:!u,children:"ì €ì¥"}),e.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:underline",children:"ì·¨ì†Œ"})]})]})]})}export{ae as RequestHelp};
